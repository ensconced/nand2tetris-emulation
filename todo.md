- sort out width of windowed code panels
- create web IO implementation for web debugger
- make code panels draggable/collapsible
- use test methods for stepping through in emulator?
- use this to debug int printing issue
- do compiling in browser with webapp, using wasm-bindgen to get result with sourcemap - then can use types generated by wasm-bindgen - no need for ts_rs?
- read docs on wasm-bindgen https://rustwasm.github.io/docs/wasm-bindgen/examples/index.html

## Ideas for reducing code size

### Identical Code Folding - i.e. automatic generation of asm "subroutines"

- code-size optimization - automatic extraction of subroutines
- remove hand-written subroutine stuff for function calls - should be covered automatically now
- refactoring - tidy up selection clearing...
- show contextual jack node
- include linting and tsc in test suite

- dead code elimination
- don't unnecessarily zero-out locals in jack code

- use an even smaller font e.g. this 5x5 px one https://www.dafont.com/5x5.font (and caps only?)

- completely skip vm code stage???

- add another hardware register???

### optimize vm compiler

- identify push/pop and just replace stack value in place?

### emulator enhancements

- add print instruction, only included when compilation is targeting the emulator
- report stack overflows etc
- add stepping ability
  - step line of jack code
  - step line of vm code
  - step asm instruction

### refactoring

- make error handling and reporting more consistent in parsers
- maybe get rid of clap and parse cli args myself

# TODO

- write full stdlib
- implement hashmap module
- implement vector module
- add SCREEN and GLYPHS variable for use in jack code
- allow use of e.g. var int[4] foo; to declare fixed-length arrays to be allocated in static section, or on stack. this could make the code in Memory.jack much neater
- make statics and stack sections bigger!
- figure out limits of current algo for two's complement multiplication - is there a simple failing example for a small negative number?
- booth's algo? or...read this: https://pages.cs.wisc.edu/~markhill/cs354/Fall2008/beyond354/int.mult.html ?
- implement proper Sys class - Sys.init should init other stdlib classes then call Main.main
- code to compile entire input directory - reuse what we already have from vm compiler
- check arg count equals param count? might be difficult - would need to look across classes sometimes...

### jack extras

- for loops
- pointers
- rudimentary typechecking? might be tricky...would need to allow some coercions - e.g. obj to int for Memory.dealloc, array to obj for constructors.
- break/continue
- more in stdlib - arrays/vectors with push method

### programs

- pong
- mandelbrot
- tetris
- game of life
- asteroids
- snake
- game selector

### hardware

- add timer?
- multiplication / division?
- floating point?
- bitshift - this would be really helpful...
- ethernet...?
- graphics: fix flickering by assigning a "don't draw" register which programs can use to flag when frame buffer is in an inconsistent state, and which the computer will read to decide whether or not to actually refresh the screen. will need to figure out how to make this work on the fpga too!
